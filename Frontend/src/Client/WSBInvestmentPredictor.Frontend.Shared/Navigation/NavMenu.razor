@using WSBInvestmentPredictor.Frontend.Shared.Navigation
@inject NavigationRegistry NavigationRegistry

<ul class="nav flex-column nav-modern">
    @foreach (var link in NavigationRegistry.Links)
    {
        @if (link is NavLinkGroup group)
        {
            <li class="nav-item mb-2">
                <div class="nav-link d-flex align-items-center gap-2" @onclick="() => ToggleGroup(group)">
                    @if (!string.IsNullOrEmpty(group.Icon))
                    {
                        <i class="@group.Icon" style="font-size: 1.3rem;"></i>
                    }
                    <span>@group.Title</span>
                    <i class="ms-auto @(group.IsExpanded ? "expand_more" : "chevron_right")" style="font-size: 1.2rem;"></i>
                </div>
                @if (group.IsExpanded)
                {
                    <ul class="nav flex-column ms-4 mt-2">
                        @foreach (var item in group.Items)
                        {
                            <li class="nav-item mb-2">
                                <NavLink class="nav-link d-flex align-items-center gap-2" href="@item.Url" Match="NavLinkMatch.All" activeClass="active">
                                    @if (!string.IsNullOrEmpty(item.Icon))
                                    {
                                        <i class="@item.Icon" style="font-size: 1.3rem;"></i>
                                    }
                                    <span>@item.Title</span>
                                </NavLink>
                            </li>
                        }
                    </ul>
                }
            </li>
        }
        else
        {
            <li class="nav-item mb-2">
                <NavLink class="nav-link d-flex align-items-center gap-2" href="@link.Url" Match="NavLinkMatch.All" activeClass="active">
                    @if (!string.IsNullOrEmpty(link.Icon))
                    {
                        <i class="@link.Icon" style="font-size: 1.3rem;"></i>
                    }
                    <span>@link.Title</span>
                </NavLink>
            </li>
        }
    }
</ul>

<style>
.nav-modern {
    background: var(--rz-surface-card);
    border-radius: 18px;
    padding: 18px 10px 18px 10px;
    /* Removed box-shadow to rely on parent RadzenSideBar shadow */
}
.nav-modern .nav-link {
    color: var(--rz-text-color);
    border-radius: 8px;
    transition: background 0.15s, color 0.15s;
    font-weight: 500;
    padding: 10px 14px;
    cursor: pointer;
}
.nav-modern .nav-link.active, .nav-modern .nav-link:hover {
    background: var(--rz-primary-lighter);
    color: var(--rz-primary);
}
.nav-modern i {
    color: var(--rz-primary);
    min-width: 24px;
    text-align: center;
}
</style>

@code {
    private void ToggleGroup(NavLinkGroup group)
    {
        group.IsExpanded = !group.IsExpanded;
    }
}
